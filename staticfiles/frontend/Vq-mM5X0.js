import{a as d,u as s,b as l}from"./BV2_MSoD.js";import{a9 as i,y as m,n as h}from"./DStkSF2J.js";function S(){const o=d().baseURL,t=i("user",()=>null),c=i("notifs",()=>[]),v=m(()=>t.value!==null),g=s("jwt");return{user:t,isAuthenticated:v,jwtLogin:async()=>{const{data:a,pending:r,error:e,refresh:p}=await l(o+"/auth/validate-token/",{headers:{Authorization:`Bearer ${g.value}`,Accept:"application/json"},method:"GET"},"$OWrSqFye87");if(a.value){t.value=a.value;const u=s("jwt");u.value=a.value.access;const n=s("username");a.value.face&&(n.value=a.value.user.username)}},login:async(a,r)=>{try{const{data:e,pending:p,error:u}=await l(o+"/auth/login/",{method:"POST",body:JSON.stringify({email:a,password:r}),headers:{"Content-Type":"application/json"}},"$gU3rt8MuY1");if(console.log(u),u.value)return console.log("Login error:",u.value),!1;if(e.value){t.value=e.value;const n=s("jwt");n.value=e.value.access;const f=s("username");return e.value.face&&(f.value=e.value.user.username),{loggedIn:!0,user_type:e.value.user.user_type,is_superuser:e.value.user.is_superuser}}}catch(e){return console.log("Error during login:",e),!1}},logout:async()=>{t.value=null;const a=s("jwt");a.value=null,h("/")},notifs:c}}export{S as u};
